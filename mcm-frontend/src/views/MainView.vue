<script setup lang="ts">

import LeftPannel from "@/components/left-side/LeftPannel.vue";
import RightPannel from "@/components/right-side/RightPannel.vue";
import MainContent from "@/components/main-content/MainContent.vue";
import { useRoute } from 'vue-router'
import {Model} from "@/types/Model.ts";
import {Node, Relation} from "@/types/Node.ts";
import {onMounted, ref} from "vue";
import {Configuration} from "@/types/Configuration.ts";
import {getConfigurationById} from "@/api/configuration.ts";
const route = useRoute()

const selectedConfiguration = ref<Configuration>();
const selectedModel = ref<Model | undefined>()
const selectedEntity = ref<Node | Relation | undefined>()
const queryResponse = ref<Record<string, any>[]>()

const getSelectedConfiguration = async () => {
  try {
    selectedConfiguration.value = await getConfigurationById({id: route.params.id as string});
  } catch (error) {
    console.error("Error fetching configuration with id " + route.params.id, error);
  }
};

onMounted(() => {
  getSelectedConfiguration();
});
</script>

<template>
  <div v-if="selectedConfiguration">
    <div class="flex h-screen">
      <LeftPannel v-model:selectedModel="selectedModel" v-model:selectedConfiguration="selectedConfiguration"/>
      <MainContent :selectedModel="selectedModel" v-model:selectedEntity="selectedEntity" v-model:response="queryResponse"/>
      <RightPannel :selectedModel="selectedModel" :selectedEntity="selectedEntity" :queryResponse="queryResponse"/>
    </div>
  </div>
</template>